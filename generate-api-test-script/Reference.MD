# ä¸€é”®å¯åŠ¨Batè„šæœ¬è§„èŒƒ
- **ä¸¥æ ¼è°¨è®°**ï¼Œæ­¤è„šæœ¬è¿è¡Œåœ¨Windowsç¯å¢ƒä¹‹ä¸Šï¼Œç¡®ä¿batæ–‡ä»¶ä¸­ä½¿ç”¨çš„å‘½ä»¤ã€è¿è¡Œæ ¼å¼ã€ç¼–ç æ ¼å¼ç¬¦åˆWindowsç¯å¢ƒ
- **Stability Constraints (æ ¸å¿ƒç¨³å®šæ€§è¦æ±‚)**
    1. **ç¦æ­¢æ·±å±‚åµŒå¥—**ï¼šç»å¯¹ä¸è¦ä½¿ç”¨æ·±å±‚åµŒå¥—çš„ `if ... ( if ... )` ç»“æ„ï¼Œå› ä¸ºè¿™ææ˜“å¯¼è‡´è¯­æ³•é”™è¯¯å’Œé—ªé€€ã€‚
    2. **ä½¿ç”¨ GOTO è·³è½¬æ¨¡å¼**ï¼šå¿…é¡»ä½¿ç”¨ `GOTO Label` çš„æ–¹å¼æ¥å¤„ç†æµç¨‹æ§åˆ¶ï¼ˆå¦‚é”™è¯¯è·³è½¬ã€å®‰è£…æˆåŠŸè·³è½¬ï¼‰ï¼Œç¡®ä¿ä»£ç æ˜¯çº¿æ€§æ‰§è¡Œçš„ã€‚
    3. **ç¼–ç å¤„ç†**ï¼šå¿…é¡»åœ¨å¼€å¤´è®¾ç½® `chcp 65001` ä»¥æ”¯æŒ UTF-8 ä¸­æ–‡è¾“å‡ºï¼Œå¹¶é‡å®šå‘è¾“å‡º `>nul` é˜²æ­¢ä¹±ç å¹²æ‰°ã€‚
    4. **è·¯å¾„å¤„ç†**ï¼šå¼€å¤´å¿…é¡»ä½¿ç”¨ `cd /d "%~dp0"` ç¡®ä¿è„šæœ¬åœ¨å½“å‰ç›®å½•ä¸‹è¿è¡Œï¼Œå³ä½¿è·¯å¾„ä¸­åŒ…å«ç©ºæ ¼ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œã€‚
    5. **å˜é‡å»¶è¿Ÿ**ï¼šå¼€å¯ `setlocal enabledelayedexpansion`ã€‚
    6. **ç”¨æˆ·ä½“éªŒ**ï¼š
        - ä½¿ç”¨ `echo =====` ç­‰ç¬¦å·åšæ¸…æ™°çš„è§†è§‰åˆ†éš”ã€‚
        - åœ¨è„šæœ¬ç»“æŸæˆ–æŠ¥é”™æ—¶ä½¿ç”¨ `pause`ï¼Œç¡®ä¿çª—å£ä¸ä¼šè‡ªåŠ¨å…³é—­ï¼Œè®©ç”¨æˆ·èƒ½çœ‹åˆ°ç»“æœã€‚
- **Example**
    ``` CMD
    @echo off
    chcp 65001 >nul
    setlocal enabledelayedexpansion
    cd /d "%~dp0"

    echo ============================================================
    echo   .NET API æµ‹è¯•å·¥å…· - ä¸€é”®å¯åŠ¨è„šæœ¬
    echo ============================================================
    echo.

    :: -----------------------------------------------------------
    :: 1. æ£€æŸ¥ Node.js
    :: -----------------------------------------------------------
    echo [1/3] æ­£åœ¨æ£€æŸ¥ Node.js ç¯å¢ƒ...

    call node -v >nul 2>nul
    if %errorlevel% neq 0 goto ErrorNode

    :: æ˜¾ç¤ºç‰ˆæœ¬
    for /f "tokens=*" %%v in ('node -v') do set NODE_VERSION=%%v
    echo âœ… Node.js ç‰ˆæœ¬: !NODE_VERSION!
    echo.


    :: -----------------------------------------------------------
    :: 2. æ£€æŸ¥ä¾èµ–åŒ… (Axios)
    :: -----------------------------------------------------------
    echo [2/3] æ­£åœ¨æ£€æŸ¥ä¾èµ–åŒ…...

    :: é€»è¾‘ä¼˜åŒ–ï¼šç›´æ¥æ£€æŸ¥ axios æ˜¯å¦å­˜åœ¨ï¼Œè€Œä¸æ˜¯åªæ£€æŸ¥ node_modules æ–‡ä»¶å¤¹
    if exist "node_modules\axios" (
        echo âœ… ä¾èµ–åŒ…å·²å®‰è£…
        goto RunTest
    )

    echo ğŸ“¦ æ­£åœ¨å®‰è£…ä¾èµ–åŒ… (axios)...
    echo    è¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´...
    echo.

    :: --- å°è¯•ä½¿ç”¨ pnpm ---
    where pnpm >nul 2>nul
    if %errorlevel% equ 0 (
        echo âœ… æ£€æµ‹åˆ° pnpmï¼Œæ­£åœ¨å®‰è£…...
        call pnpm install axios
        goto CheckInstallResult
    )

    :: --- å°è¯•ä½¿ç”¨ yarn ---
    where yarn >nul 2>nul
    if %errorlevel% equ 0 (
        echo âœ… æ£€æµ‹åˆ° yarnï¼Œæ­£åœ¨å®‰è£…...
        call yarn add axios
        goto CheckInstallResult
    )

    :: --- é»˜è®¤ä½¿ç”¨ npm ---
    echo âœ… æœªæ£€æµ‹åˆ° pnpm/yarnï¼Œä½¿ç”¨ npm å®‰è£…...
    call npm install axios

    :CheckInstallResult
    if %errorlevel% neq 0 goto ErrorInstall
    echo âœ… ä¾èµ–åŒ…å®‰è£…å®Œæˆ!
    echo.


    :: -----------------------------------------------------------
    :: 3. è¿è¡Œæµ‹è¯•
    :: -----------------------------------------------------------
    :RunTest
    echo [3/3] æ­£åœ¨å¯åŠ¨ API æµ‹è¯•å·¥å…·...
    echo ============================================================
    echo.

    :: å†æ¬¡ç¡®è®¤è„šæœ¬æ–‡ä»¶å­˜åœ¨
    if not exist "api-test.js" goto ErrorFile

    :: è¿è¡Œè„šæœ¬
    call node api-test.js

    echo.
    echo ============================================================
    echo   æµ‹è¯•æ‰§è¡Œç»“æŸ
    echo ============================================================
    echo.
    pause
    exit /b 0


    :: ===========================================================
    :: é”™è¯¯å¤„ç†åŒºåŸŸ (GOTO è·³è½¬ç‚¹)
    :: ===========================================================

    :ErrorNode
    echo.
    echo [é”™è¯¯] æœªæ£€æµ‹åˆ° Node.js!
    echo.
    echo è¯·å…ˆå®‰è£… Node.js (æ¨è LTS ç‰ˆæœ¬):
    echo 1. è®¿é—® https://nodejs.org/zh-cn/
    echo 2. ä¸‹è½½å¹¶å®‰è£…
    echo 3. é‡å¯æ­¤è„šæœ¬
    echo.
    pause
    exit /b 1

    :ErrorInstall
    echo.
    echo [é”™è¯¯] ä¾èµ–åŒ…å®‰è£…å¤±è´¥!
    echo è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œæˆ–å°è¯•æ‰‹åŠ¨è¿è¡Œ npm install axios
    echo.
    pause
    exit /b 1

    :ErrorFile
    echo.
    echo [é”™è¯¯] æœªæ‰¾åˆ° api-test.js æ–‡ä»¶!
    echo è¯·ç¡®ä¿è¯¥æ–‡ä»¶åœ¨å½“å‰ç›®å½•ä¸‹ã€‚
    echo.
    pause
    exit /b 1
    ```

# NodeJS CLIè§„èŒƒ
- Functional Requirements (åŠŸèƒ½è¦æ±‚)
    1. **ä¸»å¾ªç¯ç»“æ„**ï¼š
    - ä½¿ç”¨ `while (true)` å¾ªç¯åŒ…è£¹ä¸»ç¨‹åºé€»è¾‘ã€‚
    - æ¯æ¬¡å¾ªç¯å¼€å§‹æ—¶æ¸…å±å¹¶æ˜¾ç¤ºä¸»èœå•ï¼ˆå‡è®¾ `showMenu` å‡½æ•°å·²å­˜åœ¨ï¼‰ã€‚
    - æ ¹æ®ç”¨æˆ·é€‰æ‹©æ‰§è¡Œç›¸åº”çš„å¼‚æ­¥ä»»åŠ¡ã€‚

    2. **æŒ‰é”®æš‚åœæœºåˆ¶ (Press Enter to Continue)**ï¼š
    - åœ¨æ¯ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œä¸è¦ç«‹å³æ¸…å±æˆ–é‡æ–°æ˜¾ç¤ºèœå•ã€‚
    - è¾“å‡ºæç¤ºæ–‡æœ¬ï¼šâ€œæŒ‰å›è½¦é”®è¿”å›ä¸»èœå•...â€ã€‚
    - ç¨‹åºè¿›å…¥ **é˜»å¡ç­‰å¾…çŠ¶æ€**ï¼Œç›´åˆ°ç”¨æˆ·æŒ‰ä¸‹å›è½¦é”®ã€‚

    3. **Technical Implementation (æŠ€æœ¯å®ç°)**ï¼š
    - ä½¿ç”¨ Node.js åŸç”Ÿ `process.stdin` å®ç°ï¼Œä¸ä¾èµ–ç¬¬ä¸‰æ–¹åº“ã€‚
    - åˆ›å»ºä¸€ä¸ªåä¸º `waitKeyPress` çš„ Promise å‡½æ•°æ¥å®ç°æš‚åœã€‚
    - åœ¨ç­‰å¾…æœŸé—´å¼€å¯ `stdin.setRawMode(true)` ä»¥æ•è·æŒ‰é”®ã€‚
    - æ•è·åˆ°å›è½¦é”® (`\r` æˆ– `\n`) åï¼š
        1. å…³é—­ Raw Mode (`stdin.setRawMode(false)`).
        2. ç§»é™¤äº‹ä»¶ç›‘å¬å™¨ (é¿å…å†…å­˜æ³„æ¼).
        3. Resolve Promise ä»¥ç»§ç»­æ‰§è¡Œã€‚..
- Example Code Structure (å‚è€ƒç»“æ„),è¯·å‚è€ƒä»¥ä¸‹é€»è¾‘æµç¼–å†™ `main` å‡½æ•°ï¼š
    ```javascript
    async function main() {
        console.clear();
        log('ğŸ§ª .NET API æµ‹è¯•å·¥å…·', colors.bold);
        log('OpenAPI 3.1.1 æµ‹è¯•è„šæœ¬', colors.gray);
        log('');

        // Check Node.js
        log(`Node.js ç‰ˆæœ¬: ${process.version}`, colors.gray);
        log(`æœåŠ¡å™¨åœ°å€: ${CONFIG.BASE_URL}`, colors.gray);
        log(`ç«¯å£: ${CONFIG.PORT}`, colors.gray);
        log('');

        // Login
        await login();
        await delay(500);

        // Show menu
        while (true) {
            const mode = await showMenu();

            if (mode === 'exit') {
            log('\nğŸ‘‹ å†è§!', colors.green);
            process.exit(0);
            }

            currentMode = mode;
            console.clear();
            log('ğŸ§ª å¼€å§‹æµ‹è¯•...', colors.cyan);
            log('');

            let result;
            const startTime = Date.now();

            try {
            if (mode === 'single') {
                result = await executeSingleTest();
                generateReport(result, 'å•ä¸€æµ‹è¯•');
            } else if (mode === 'module') {
                result = await executeBusinessModuleTest();
                generateReport(result, 'ä¸šåŠ¡æ¨¡å—æµ‹è¯•');
            } else if (mode === 'integration') {
                result = await executeBusinessIntegrationTest();
                generateReport(result, 'ä¸šåŠ¡é›†æˆæµ‹è¯•');
            }

            const totalTime = Date.now() - startTime;
            log(`\nâ±ï¸  æ€»æ‰§è¡Œæ—¶é—´: ${totalTime}ms`, colors.cyan);

            } catch (error) {
            log(`\nâŒ æµ‹è¯•æ‰§è¡Œå‡ºé”™: ${error.message}`, colors.red);
            console.error(error);
            }

            log('\næŒ‰å›è½¦é”®è¿”å›èœå•...', colors.gray);
            await new Promise(resolve => {
            stdin.setRawMode(true);
            stdin.resume();
            stdin.setEncoding('utf8');
            const onData = (key) => {
                if (key === '\r' || key === '\n' || key === '\u0003') {
                stdin.setRawMode(false);
                stdin.pause();
                stdin.removeListener('data', onData);
                resolve();
                }
            };
            stdin.on('data', onData);
            });
        }
    }